(function(e,t){function s(e,t,s,r,a,d){this.divId=e,this.className=t,this.metricName=s,this.max=r,this.title=a,this.type=d,this.getMax=function(){return this.max},this.getMetricNode=function(e,t,s){return s[e]?s[e][t]:null}}function r(e,t){var s=100*(e/t);return s.toFixed(0)}function a(e,t){return t||(t=1),e.toFixed(t)}function d(e){return e.charAt(0).toUpperCase()+e.slice(1)}function n(e,t,r,a,d,n,i,o){var m=new s(e,t,r,a,d,"timer");return m.getMeterInfo=function(){var e=this.divId+" div.timerGraph td.meterGraph",t=new s(e,this.className,this.metricName,this.max,"Frequency","meter");return t.getMetricNode=function(e,t,s){return s[e]?s[e][t].rate:null},t.eventType=n,t},m.getTimerStatsDivId=function(){return"#"+this.divId+" div.timerGraph td.timerStatsGraph"},m.getTimerHistogramDivId=function(){return"#"+this.divId+" div.timerGraph td.timerHistogram"},m.durationMax=i,m.isNested=o,m}function i(e){var s=t("#"+e.divId),r="<div class='metricsWatcher counter counterGraph'><h3>"+e.title+"</h3><div class='progress'><div class='bar' style='width: 0%;'></div></div></div>";s.html(r)}function o(e,s){var a=e.getMetricNode(e.className,e.metricName,s),d=r(a.count,e.getMax(s));t("#"+e.divId+" div.progress div.bar").css("width",d+"%"),t("#"+e.divId+" div.progress div.bar").html(a.count+"/"+e.getMax(s))}function m(e){var s=t("#"+e.divId),r=e.isNested?" nested":"",a="<div class='metricsWatcher timer timerGraph"+r+"'>"+"<fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='timerContainer span12'>"+"<table><tr>"+"<td class='meterGraph span4'></td>"+"<td class='timerStatsGraph span4'></td>"+"<td class='timerHistogram span4'></td>"+"</tr></table></div></fieldset>";s.html(a),g(e.getMeterInfo()),l(e),c(e)}function l(e){var s="<h3>Duration</h3><p></p><div class='metricGraph'><table class='progressTable'>"+f("Min","min")+f("Mean","mean")+f("Median","median")+f("Max","max")+f("Std&nbsp;Dev","std_dev")+"</table></div>",r=t(e.getTimerStatsDivId());r.html(s)}function c(e){var s="<h3>Histogram</h3><p>Percentiles</p><div class='metricGraph'><table class='progressTable'>"+f("99.9%","p999")+f("99%","p99")+f("98%","p98")+f("95%","p95")+f("75%","p75")+"</table></div>",r=t(e.getTimerHistogramDivId());r.html(s)}function u(e,t){b(e.getMeterInfo(),t),h(e,t),v(e,t)}function h(e,s){var r=e.getMetricNode(e.className,e.metricName,s).duration,a=t(e.getTimerStatsDivId()+" p");a.html(d(r.unit)),p(e.getTimerStatsDivId(),r,"min",e.durationMax),p(e.getTimerStatsDivId(),r,"mean",e.durationMax),p(e.getTimerStatsDivId(),r,"median",e.durationMax),p(e.getTimerStatsDivId(),r,"max",e.durationMax),p(e.getTimerStatsDivId(),r,"std_dev",e.durationMax)}function p(e,s,d,n){t(e+" tr."+d+" td.progressValue").html(a(s[d])),t(e+" tr."+d+" td.progressBar div.progress div.bar").css("width",r(s[d],n)+"%")}function v(e,t){var s=e.getMetricNode(e.className,e.metricName,t).duration;p(e.getTimerHistogramDivId(),s,"p999",e.durationMax),p(e.getTimerHistogramDivId(),s,"p99",e.durationMax),p(e.getTimerHistogramDivId(),s,"p98",e.durationMax),p(e.getTimerHistogramDivId(),s,"p95",e.durationMax),p(e.getTimerHistogramDivId(),s,"p75",e.durationMax)}function g(e){var s=t("#"+e.divId),r="<div class='metricsWatcher metric metricGraph'><h3>"+e.title+"</h3><p></p><table class='progressTable'>"+f("1&nbsp;min","onemin")+f("5&nbsp;min","fivemin")+f("15&nbsp;min","fifteenmin")+f("Mean","mean")+"</table></div>";s.html(r)}function f(e,t){return"<tr class='"+t+"'><td class='progressLabel'>"+e+"</td>"+"<td class='progressBar'><div class='progress'><div class='bar' style='width: 0%;'></div>"+"</div></td><td class='progressValue'>0</td></tr>"}function b(e,t){var s=e.getMetricNode(e.className,e.metricName,t);s&&w(e,s)}function w(e,s){var r=t("#"+e.divId+" p"),a=e.eventType;a||(a=s.event_type),s.count>1&&"get"===a?a="gets":s.count>1&&"put"===a&&(a="puts");var d=s.unit;"seconds"===d&&(d="second"),r.html(a+" per "+d+" ("+s.count+" total)"),I(e,s,"mean","mean"),I(e,s,"m1","onemin"),I(e,s,"m5","fivemin"),I(e,s,"m15","fifteenmin")}function I(e,s,d,n){t("#"+e.divId+" tr."+n+" td.progressValue").html(a(s[d])),t("#"+e.divId+" tr."+n+" td.progressBar div.progress div.bar").css("width",r(s[d],e.max)+"%")}function y(e){var s=t("#"+e.divId),r="<div class='metricsWatcher metric metricGraph'><h3>"+e.title+"</h3><h1></h1></div>";s.html(r)}function M(e,t){var s=e.getMetricNode(e.className,e.metricName,t);s&&S(e,s)}function S(e,s){var r=t("#"+e.divId+" h1");r.html(s.value)}function C(e,s){var r=t("#"+e),a="<div class='metricsWatcher metric metricGraph nested'><fieldset><legend><h1>"+s+"</h1></legend>"+"<div class='gaugeTableContainer'><table class='gaugeTable'></table></div></fieldset></div>";r.html(a)}function T(e,s,r){for(var a=t("#"+e+" table"),d="",n=s.length,i=0;n>i;i++){var o=s[i];d+="<tr><td><h5>"+o.title+"</h5></td>"+"<td><h4>"+o.getMetricNode(o.className,o.metricName,r).value+"</h4></td></tr>"}a.html(d)}function G(e){var s=t("#"+e.divId),r="<div class='metricsWatcher cache cacheGraph span12'><fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='cacheContainer span12'>"+"	<div class='row-fluid'>"+"		<div class='span3'><div id='"+e.divId+"Statistics'></div></div>"+"		<div class='span9'>"+"			<div id='"+e.divId+"gettimer'></div>"+"			<div id='"+e.divId+"puttimer'></div>"+"		</div>"+"	</div>"+"</div></fieldset></div>";s.html(r);for(var a=e.components.gauges.length,d=0;a>d;d++)y(e.components.gauges[d]);m(e.getTimer),m(e.putTimer),C(e.divId+"Statistics","Statistics",e.components.gauges)}function N(e,s){for(var r=e.components.gauges.length,a=0;r>a;a++){var d=e.components.gauges[a],n=d.getMetricNode(e.className,d.metricName,s);if(n){var i=t("#"+d.divId+" div.metricGraph h1");i.html(n.value)}}u(e.getTimer,s),u(e.putTimer,s),T(e.divId+"Statistics",e.components.gauges,s)}function x(e){var s=t("#"+e.divId),r="<div class='metricsWatcher jvm metricGraph span12'><fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='jvmContainer span12'>"+"	<div id='"+e.divId+"Vm'></div>"+"</div>"+"</fieldset></div>";s.html(r)}function H(e,s){var r=t("#"+e.divId+"Vm"),d=s[e.className],n="<div class='row-fluid'><div class='span3'><table class='jvmTable'><tr><td class='rowName'><h5>Name</h5></td><td>"+d.vm.name+"</td></tr>"+"<tr><td><h5>Version</h5></td><td>"+d.vm.version+"</td></tr>"+"<tr><td><h5>Current Time</h5></td><td>"+d.current_time+"</td></tr>"+"<tr><td><h5>Uptime</h5></td><td>"+d.uptime+"</td></tr>"+"<tr><td><h5>FD Usage</h5></td><td>"+a(d.fd_usage,2)+"</td></tr>"+"<tr><td><h5>Daemon Threads</h5></td><td>"+d.daemon_thread_count+"</td></tr>"+"<tr><td><h5>Threads</h5></td><td>"+d.thread_count+"</td></tr>"+"</table></div>"+"<div class='span3'><table class='jvmTable'>"+"<tr><td><h5>Total Init</h5></td><td>"+d.memory.totalInit+"</td></tr>"+"<tr><td><h5>Total Used</h5></td><td>"+d.memory.totalUsed+"</td></tr>"+"<tr><td><h5>Total Max</h5></td><td>"+d.memory.totalMax+"</td></tr>"+"<tr><td><h5>Total Committed</h5></td><td>"+d.memory.totalCommitted+"</td></tr>"+"<tr><td><h5>Heap Init</h5></td><td>"+d.memory.heapInit+"</td></tr>"+"<tr><td><h5>Heap Used</h5></td><td>"+d.memory.heapUsed+"</td></tr>"+"<tr><td><h5>Heap Max</h5></td><td>"+d.memory.heapMax+"</td></tr>"+"<tr><td><h5>Heap Committed</h5></td><td>"+d.memory.heapCommitted+"</td></tr>"+"<tr><td><h5>Heap Usage</h5></td><td>"+a(d.memory.heap_usage,2)+"</td></tr>"+"<tr><td><h5>Non Heap Usage</h5></td><td>"+a(d.memory.non_heap_usage,2)+"</td></tr>"+"</table></div>"+"<div class='span3'><table class='jvmTable'>"+"<tr><td><h5>Code Cache</h5></td><td>"+a(d.memory.memory_pool_usages["Code Cache"],2)+"</td></tr>"+"<tr><td><h5>PS Eden Space</h5></td><td>"+a(d.memory.memory_pool_usages["PS Eden Space"],2)+"</td></tr>"+"<tr><td><h5>PS Old Gen</h5></td><td>"+a(d.memory.memory_pool_usages["PS Old Gen"],2)+"</td></tr>"+"<tr><td><h5>PS Perm Gen</h5></td><td>"+a(d.memory.memory_pool_usages["PS Perm Gen"],2)+"</td></tr>"+"<tr><td><h5>PS Survivor Space</h5></td><td>"+a(d.memory.memory_pool_usages["PS Survivor Space"],2)+"</td></tr>"+"<tr><td><h5>PS Mark Sweep Runs</h5></td><td>"+d["garbage-collectors"]["PS MarkSweep"].runs+"</td></tr>"+"<tr><td><h5>PS Mark Sweep Time</h5></td><td>"+d["garbage-collectors"]["PS MarkSweep"].time+"</td></tr>"+"<tr><td><h5>PS Scavenge Runs</h5></td><td>"+d["garbage-collectors"]["PS Scavenge"].runs+"</td></tr>"+"<tr><td><h5>PS Scavenge Time</h5></td><td>"+d["garbage-collectors"]["PS Scavenge"].time+"</td></tr>"+"</table></div>"+"<div class='span3'><table class='jvmTable'>"+"<tr><td><h5>Terminated</h5></td><td>"+d["thread-states"].terminated+"</td></tr>"+"<tr><td><h5>Timed Waiting</h5></td><td>"+a(d["thread-states"].timed_waiting,2)+"</td></tr>"+"<tr><td><h5>Blocked</h5></td><td>"+a(d["thread-states"].blocked,2)+"</td></tr>"+"<tr><td><h5>Waiting</h5></td><td>"+a(d["thread-states"].waiting,2)+"</td></tr>"+"<tr><td><h5>Runnable</h5></td><td>"+a(d["thread-states"].runnable,2)+"</td></tr>"+"<tr><td><h5>New</h5></td><td>"+d["thread-states"]["new"]+"</td></tr>"+"</table></div></div>";r.html(n)}function D(e){var s=t("#"+e.divId),r="<div class='metricsWatcher web metricGraph span12'><fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='webContainer span12'>"+"	<div id='"+e.divId+"Web'></div>"+"<table><tr>"+"<td colspan='4' class='requestsGraph span12'></td>"+"</tr><tr>"+"<td class='activeRequestsGraph span3'></td>"+"<td class='responseCodesOkGraph span3'></td>"+"<td class='responseCodesCreatedGraph span3'></td>"+"<td class='responseCodesOtherGraph span3'></td>"+"</tr><tr>"+"<td class='responseCodesBadRequestGraph span3'></td>"+"<td class='responseCodesNoContentGraph span3'></td>"+"<td class='responseCodesNotFoundGraph span3'></td>"+"<td class='responseCodesServerErrorGraph span3'></td>"+"</tr></table>"+"</div>"+"</fieldset></div>";s.html(r),m(e.components.requestsInfo),i(e.components.activeRequestsInfo);for(var a=e.components.meters.length,d=0;a>d;d++)g(e.components.meters[d])}function _(e,t){u(e.components.requestsInfo,t),o(e.components.activeRequestsInfo,t);for(var s=e.components.meters.length,r=0;s>r;r++)b(e.components.meters[r],t)}e.addGauge=function(e,t,r,a){var d=new s(e,t,r,null,a,"gauge");q.push(d)},e.addMeter=function(e,t,r,a,d){var n=new s(e,t,r,a,d,"meter");q.push(n)},e.addCounter=function(e,t,r,a,d){var n=new s(e,t,r,a,d,"counter");q.push(n)},e.addLinkedCounter=function(e,t,r,a,d,n){var i=new s(e,t,r,null,n,"counter");i.maxClassName=a,i.maxMetricName=d,i.getMax=function(e){var t=this.getMetricNode(this.maxClassName,this.maxMetricName,e);return t.count},q.push(i)},e.addTimer=function(e,t,s,r,a,d,i){var o=n(e,t,s,r,a,d,i,!1);q.push(o)},e.addCache=function(e,t,r){var a=new s(e,t,null,null,r,"cache");a.components={gauges:[new s(null,t,"hits",null,"Hits","gauge"),new s(null,t,"misses",null,"Misses","gauge"),new s(null,t,"objects",null,"Objects","gauge"),new s(null,t,"eviction-count",null,"Eviction Count","gauge"),new s(null,t,"in-memory-hits",null,"In Memory Hits","gauge"),new s(null,t,"in-memory-misses",null,"In Memory Misses","gauge"),new s(null,t,"in-memory-objects",null,"In Memory Objects","gauge"),new s(null,t,"off-heap-hits",null,"Off Heap Hits","gauge"),new s(null,t,"off-heap-misses",null,"Off Heap Misses","gauge"),new s(null,t,"off-heap-objects",null,"Off Heap Objects","gauge"),new s(null,t,"on-disk-hits",null,"On Disk Hits","gauge"),new s(null,t,"on-disk-misses",null,"On Disk Misses","gauge"),new s(null,t,"on-disk-objects",null,"On Disk Objects","gauge"),new s(null,t,"mean-get-time",null,"Mean Get Time","gauge"),new s(null,t,"mean-search-time",null,"Mean Search Time","gauge"),new s(null,t,"searches-per-second",null,"Searches Per Sec","gauge"),new s(null,t,"writer-queue-size",null,"Writer Queue Size","gauge"),new s(null,t,"accuracy",null,"Accuracy","gauge")]},a.getTimer=n(e+"gettimer",t,"get",1e3,"Get","get",1e3,!0),a.putTimer=n(e+"puttimer",t,"put",1e3,"Put","put",1e4,!0),q.push(a)},e.addJvm=function(e,t,r){var a=new s(e,t,null,null,r,"jvm");q.push(a)},e.addWeb=function(e,t,r){var a=new s(e,t,null,null,r,"web");a.components={meters:[new s(e+" td.responseCodesOkGraph",t,"responseCodes.ok",10,"OK Responses","meter"),new s(e+" td.responseCodesBadRequestGraph",t,"responseCodes.badRequest",10,"Bad Requests","meter"),new s(e+" td.responseCodesCreatedGraph",t,"responseCodes.created",10,"Created Responses","meter"),new s(e+" td.responseCodesNoContentGraph",t,"responseCodes.noContent",10,"No Content Responses","meter"),new s(e+" td.responseCodesNotFoundGraph",t,"responseCodes.notFound",10,"Not Found Responses","meter"),new s(e+" td.responseCodesOtherGraph",t,"responseCodes.other",10,"Other Responses","meter"),new s(e+" td.responseCodesServerErrorGraph",t,"responseCodes.serverError",10,"Server Error Responses","meter")],activeRequestsInfo:new s(e+" td.activeRequestsGraph",t,"activeRequests",10,"Active Requests","counter"),requestsInfo:n(e+" td.requestsGraph",t,"requests",100,"Requests","requests",100,!0)},q.push(a)},e.initGraphs=function(){for(var e=0;e<q.length;e++)q[e].type=="gauge"?y(q[e]):q[e].type=="meter"?g(q[e]):q[e].type=="counter"?i(q[e]):q[e].type=="timer"?m(q[e]):q[e].type=="cache"?G(q[e]):q[e].type=="jvm"?x(q[e]):q[e].type=="web"?D(q[e]):alert("Unknown meter info type: "+q[e].type)},e.updateGraphs=function(e){for(var t=0;t<q.length;t++)q[t].type=="gauge"?M(q[t],e):q[t].type=="meter"?b(q[t],e):q[t].type=="counter"?o(q[t],e):q[t].type=="timer"?u(q[t],e):q[t].type=="cache"?N(q[t],e):q[t].type=="jvm"?H(q[t],e):q[t].type=="web"?_(q[t],e):alert("Unknown meter info type: "+q[t].type)};var q=[]})(window.metricsWatcher=window.metricsWatcher||{},jQuery);